<%- include('../includes/head.ejs') %>
<link rel="stylesheet" href="/css/producto.css">
<link rel="stylesheet" href="/css/main.css">

<body>
    <main>
        <!-- Keep the navigation header at the top -->
        <%- include('../includes/navigation.ejs') %>

        <!-- Wrapper for left and right content -->
        <div class="content-wrapper">
            <!-- Left-aligned content for registration form -->
            <div class="left-aligned-content">
                <form action='/registro' method="POST" class="m-5 d-flex flex-column align-items-center" novalidate>
                    <h2>REGÍSTRATE</h2>

                    <% if (mensajeError) { %>
                        <div class="alert alert-danger"><%= mensajeError %></div>
                    <% } %>
                    
                    <!-- Espacio para Nombres -->
                    <div class="mb-3 w-50">
                        <label for="nombre" class="form-label">Nombres</label>
                        <input type="text" name="nombre" 
                            class="form-control <%= validationErrors && validationErrors.find(e => e.path === 'nombre') ? 'border-danger' : '' %>" 
                            id="nombre" required>
                    </div>

                    <!-- Espacio para Dirección de correo-->
                    <div class="mb-3 w-50">
                        <label for="email" class="form-label">Dirección de correo</label>
                        <input 
                            class="form-control <%= validationErrors && validationErrors.find(e => e.path === 'email') ? 'border-danger' : '' %>"
                            type="email" 
                            name="email" 
                            id="email" 
                            required
                        >
                        <% if (validationErrors && validationErrors.find(e => e.param === 'email')) { %>
                            <div class="error-message">
                                <%= validationErrors.find(e => e.param === 'email').msg %>
                            </div>
                        <% } %>
                    </div>

                    <!-- Espacio para DNI -->
                    <div class="mb-3 w-50">
                        <label for="dni" class="form-label">DNI</label>
                        <input type="text" name="dni" 
                            class="form-control <%= validationErrors && validationErrors.find(e => e.path === 'dni') ? 'border-danger' : '' %>"
                            id="dni" required>
                    </div>

                    <!-- Espacio para Contraseña -->
                     
                     <!-- Espacio para Contraseña -->
                    <div class="mb-3 w-50">
                    <label for="password" class="form-label">Contraseña</label>
                    <div class="form-text">Min: 8 caracteres (incluir letra mayúscula y minúscula, número y caracter especial)</div>
                    <input 
                        class="form-control <%= validationErrors.find(e => e.path === 'password') ? 'border-danger' : '' %>"
                        type="password" 
                        name="password"  
                        id="password" 
                        minlength="6" required>
                    <small id="password-strength-text"></small>
                    <div id="password-strength-bar" style="height: 5px; width: 100%; background-color: #ddd;"></div>
                    </div>


                    <!-- Espacio para Reescribir Contraseña -->
                     <!-- Espacio para Reescribir Contraseña -->
                    <div class="mb-3 w-50">
                        <label for="confirmPassword" class="form-label">Vuelva a escribir la contraseña</label>
                        <input 
                            class="form-control <%= validationErrors.find(e => e.path === 'confirmPassword') ? 'border-danger' : '' %>"
                            type="password" 
                            name="confirmPassword"  
                            id="confirmPassword" 
                            minlength="6" required>
                    </div>

                    <!-- Mensaje de confirmación de correo -->
                    <p class="text-muted w-50">Se enviará un mensaje a tu dirección de correo electrónico como bienvenida.</p>

                    <!-- Mensaje sobre el uso de datos personales -->
                    <p class="text-muted w-50">
                        Tus datos personales se utilizarán para procesar tu pedido, mejorar tu
                        experiencia en esta web, gestionar el acceso a tu cuenta y otros
                        propósitos descritos en nuestra <a href="#">política de privacidad</a>.
                    </p>
                    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
                    <!-- Botón de registro -->
                    <button type="submit" class="btn btn-verde w-50">Regístrate</button>

                    <script type="module">
                        import { checkPasswordStrength } from '/utils/checkPasswordStrength.js';
                        document.getElementById('password').addEventListener('input', checkPasswordStrength);
                    </script>
                </form>
            </div>

            <!-- Right-aligned content for login form -->
            <div class="right-aligned-content">
                <form action='/login' method="GET" class="m-5 d-flex flex-column align-items-center">
                    <h2>INICIAR SESIÓN</h2>
                    <!-- Mensaje para la sección de iniciar sesión -->
                    <p class="text-muted w-50">
                        Al iniciar sesión, tendrás acceso a tu historial de pedidos, podrás gestionar
                        tus datos personales y seguir el estado de tus compras. Asegúrate de ingresar
                        correctamente tu dirección de correo electrónico y contraseña para evitar problemas de acceso.
                    </p>
                    <!-- Botón de inicio de sesión -->
                    <button type="submit" class="btn btn-verde w-50">Iniciar sesión</button>
                </form>
            </div>
        </div>
    </main>

<%- include('../includes/end.ejs') %>


